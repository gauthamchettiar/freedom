{{- /*
  Render Codeblock Hook
  
  Renders code blocks with syntax highlighting and optional display label.
  - Display label is positioned at the top right (via {display="..."} attribute)
  - Falls back to language type if display is not provided
  - Control visibility with {showLang=false} attribute (default: true)
  - Control copy button with {showCopy=false} attribute (default: true)
  - Make full-width with {wide=true} attribute (default: false)
  
  Examples:
    ```go {display="main.go"}
    package main
    ```
    
    ```go {showLang=false}
    package main
    ```
    
    ```go {wide=true}
    package main
    ```
*/ -}}

{{- $showLang := .Attributes.showlang | default (partial "utils/config.html" (dict "key" "showCodeblockLang" "default" true)) -}}
{{- $showCopy := .Attributes.showcopy | default (partial "utils/config.html" (dict "key" "showCodeblockCopy" "default" true)) -}}
{{- $wide := .Attributes.wide | default false -}}

{{- $class := cond $wide "codeblock codeblock-wide" "codeblock" -}}

<div class="{{ $class }}">
  {{- $displayLabel := .Attributes.display | default .Type -}}
  {{- if and $showCopy $displayLabel -}}
  <button class="codeblock-copy chroma" aria-label="Copy code" title="Copy code">
    <span class="cl">{{ partial "icon.html" (dict "name" "copy" "class" "icon-sm") }}</span>
  </button>
  {{- end -}}
  {{- if and $showLang $displayLabel -}}
    <div class="codeblock-lang chroma"><span class="cl">{{ $displayLabel }}</span></div>
  {{- end -}}
  {{ highlight .Inner .Type .Options }}
</div>
