{{- /*
  Render Table Hook
  
  Renders markdown tables with optional width control, caption, and alignment.
  - width: Control table width (compact/full/wide)
    - compact (default): Table width fits content
    - full: Full width of page content (--page-width)
    - wide: Full viewport width
  - caption: Add a caption below the table
  - align: Align table and caption (left/center/right)
  
  Examples:
    | Header 1 | Header 2 |
    | -------- | -------- |
    | Cell 1   | Cell 2   |
    {width="full" caption="Table 1: Sample data" align="center"}
*/ -}}

{{- $width := .Attributes.width | default "compact" -}}
{{- $caption := .Attributes.caption | default "" -}}
{{- $align := .Attributes.align | default "" -}}

{{- /* Build CSS classes */ -}}
{{- $classes := slice -}}
{{- if eq $width "full" -}}
  {{- $classes = $classes | append "table-full" -}}
{{- else if eq $width "wide" -}}
  {{- $classes = $classes | append "table-wide" -}}
{{- end -}}
{{- if $align -}}
  {{- $classes = $classes | append (printf "table-align-%s" $align) -}}
{{- end -}}
{{- $wrapperClass := delimit $classes " " -}}

{{- if or $wrapperClass $caption -}}
<figure class="table-figure{{ if $wrapperClass }} {{ $wrapperClass }}{{ end }}">
{{- end -}}
<table
  {{- range $k, $v := .Attributes }}
    {{- if and $v (ne $k "width") (ne $k "caption") (ne $k "align") }}
      {{- printf " %s=%q" $k $v | safeHTMLAttr }}
    {{- end }}
  {{- end }}>
  <thead>
    {{- range .THead }}
      <tr>
        {{- range . }}
          <th
            {{- with .Alignment }}
              {{- printf " style=%q" (printf "text-align: %s" .) | safeHTMLAttr }}
            {{- end -}}
          >
            {{- .Text -}}
          </th>
        {{- end }}
      </tr>
    {{- end }}
  </thead>
  <tbody>
    {{- range .TBody }}
      <tr>
        {{- range . }}
          <td
            {{- with .Alignment }}
              {{- printf " style=%q" (printf "text-align: %s" .) | safeHTMLAttr }}
            {{- end -}}
          >
            {{- .Text -}}
          </td>
        {{- end }}
      </tr>
    {{- end }}
  </tbody>
</table>
{{- if $caption -}}
  <figcaption>{{ $caption }}</figcaption>
{{- end -}}
{{- if or $wrapperClass $caption -}}
</figure>
{{- end -}}