{{- /*
  Read Time Widget
  
  Calculates and displays estimated reading time for a page.
  
  Parameters:
    - page (required): Page context
    - site (required): Site context
    - wordsPerMinute (optional): Reading speed in words per minute (default: 200)
    - class (optional): Additional CSS classes
    - key (optional): Config key for visibility (default: "showReadTime")
  
  Example:
    {{ partial "widgets/meta/read-time.html" (dict "page" . "site" .Site) }}
    {{ partial "widgets/meta/read-time.html" (dict "page" . "site" .Site "wordsPerMinute" 250) }}
*/ -}}


{{- $key := .key | default "ReadTime" -}}
{{- $class := .class | default "" -}}

{{ $showReadTime := (partial "utils/config.html" (dict "key" (print "show" $key) "default" true)) }}
{{ $showReadTimeIcon := (partial "utils/config.html" (dict "key" (print "show" $key "Icon") "default" true)) }}
{{ $readTimeWordsPerMinute := (partial "utils/config.html" (dict "key" (print $key "WordsPerMinute") "default" (.wordsPerMinute | default 200))) -}}


{{- $wordCount := page.WordCount -}}
{{- $readTime := div $wordCount $readTimeWordsPerMinute -}}
{{- if lt $readTime 1 -}}
  {{- $readTime = 1 -}}
{{- end -}}

{{ if $showReadTime }}
  <span class="read-time {{ $class }}">
    {{- if $showReadTimeIcon -}}
      {{ partialCached "icon.html" (dict "name" "clock" "style" "regular") "clock" "regular" }}&nbsp;&nbsp;
    {{- end -}}
    {{- $readTime }} {{ i18n "read_time_min" | default "min" }}
  </span>
{{ end }}
