{{- /*
  Read Time Widget
  
  Calculates and displays estimated reading time for a page.
  
  Parameters:
    - page (required): Page context
    - site (required): Site context
    - wordsPerMinute (optional): Reading speed in words per minute (default: 200)
    - class (optional): Additional CSS classes
    - key (optional): Config key for visibility (default: "showReadTime")
  
  Example:
    {{ partial "widgets/meta/read-time.html" (dict "page" . "site" .Site) }}
    {{ partial "widgets/meta/read-time.html" (dict "page" . "site" .Site "wordsPerMinute" 250) }}
*/ -}}

{{- $page := .page -}}
{{- $site := .site -}}
{{- $key := .key | default "showReadTime" -}}
{{- $class := .class | default "" -}}
{{- $wordsPerMinute := .wordsPerMinute | default 200 -}}

{{ $showReadTime := (partial "config.html" (dict "page" $page "site" $site "key" $key)) }}
{{ $showReadTimeIcon := (partial "config.html" (dict "page" $page "site" $site "key" (print $key "Icon"))) }}

{{- $wordCount := $page.WordCount -}}
{{- $readTime := div $wordCount $wordsPerMinute -}}
{{- if lt $readTime 1 -}}
  {{- $readTime = 1 -}}
{{- end -}}

{{ if $showReadTime }}
  <span class="read-time {{ $class }}">
    {{- if $showReadTimeIcon -}}
      {{ partialCached "widgets/icon.html" (dict "name" "clock" "style" "regular") "clock" "regular" }}&nbsp;&nbsp;
    {{- end -}}
    {{- $readTime }} min
  </span>
{{ end }}
