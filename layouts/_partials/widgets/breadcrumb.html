{{- /*
  Breadcrumb Navigation Widget
  
  Displays breadcrumb navigation based on page ancestors.
  First ancestor is always labeled "Home".
  
  Parameters:
    - page (required): Page context
    - site (required): Site context
    - separator (optional): Separator between items (default: " » ")
    - class (optional): Additional CSS classes
    - key (optional): Config key for visibility (default: "showBreadcrumb")
    - showCurrentPage (optional): Show current page in breadcrumb (default: false)
  
  Example:
    {{ partial "widgets/breadcrumb.html" (dict "page" . "site" .Site) }}
    {{ partial "widgets/breadcrumb.html" (dict "page" . "site" .Site "separator" " / ") }}
    {{ partial "widgets/breadcrumb.html" (dict "page" . "site" .Site "showCurrentPage" false) }}
*/ -}}

    
{{- $key := .key | default "Breadcrumb" -}}
{{- $class := .class | default "" -}}
{{- $showCurrentPage := .showCurrentPage | default false -}}

{{ $showBreadcrumb := (partial "utils/config.html" (dict "key" (print "show" $key) "default" true)) }}
{{ $breadcrumbSeparator := (partial "utils/config.html" (dict "key" (print $key "Separator") "default" (.separator | default " » "))) }}

{{- if $showBreadcrumb -}}
<div class="breadcrumbs kind-{{ page.Kind }} section-{{ page.Section }} type-{{ page.Type }} {{ $class }}">
    {{- with page.Ancestors.Reverse -}}
        {{- range $index, $ancestor := . -}}
            {{- if eq $index 0 -}}
                <a href="{{ .RelPermalink }}">Home</a>
            {{- else -}}
                <a href="{{ .RelPermalink }}">{{ .Title }}</a>
            {{- end -}}
            {{ $breadcrumbSeparator }}
        {{- end -}}
    {{- else -}}
        {{- if $showCurrentPage -}}
            <a href="/">Home</a>{{ $breadcrumbSeparator }}
        {{- else -}}
            <a href="/">Home</a>
        {{- end -}}
    {{- end -}}
    {{- if $showCurrentPage -}}
        <a href="{{ page.RelPermalink }}" class="breadcrumb-current"><strong>{{ page.Title }}</strong></a>
    {{- end -}}
</div>
{{- end -}}
