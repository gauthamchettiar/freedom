{{- /*
  Breadcrumb Navigation Widget
  
  Displays breadcrumb navigation based on page ancestors.
  First ancestor is always labeled "Home".
  
  Parameters:
    - page (required): Page context
    - site (required): Site context
    - separator (optional): Separator between items (default: " » ")
    - class (optional): Additional CSS classes
    - key (optional): Config key for visibility (default: "showBreadcrumb")
  
  Example:
    {{ partial "widgets/breadcrumb.html" (dict "page" . "site" .Site) }}
    {{ partial "widgets/breadcrumb.html" (dict "page" . "site" .Site "separator" " / ") }}
*/ -}}

    
{{- $key := .key | default "Breadcrumb" -}}
{{- $class := .class | default "" -}}

{{ $showBreadcrumb := (partial "utils/config.html" (dict "key" (print "show" $key) "default" true)) }}
{{ $breadcrumbSeparator := (partial "utils/config.html" (dict "key" (print $key "Separator") "default" (.separator | default " » "))) }}

{{- if $showBreadcrumb -}}
<div class="breadcrumbs kind-{{ page.Kind }} section-{{ page.Section }} type-{{ page.Type }} {{- $class -}}">
    {{- with page.Ancestors.Reverse -}}
        {{- $lastIndex := sub (len .) 1 -}}
        {{- range $index, $ancestor := . -}}
            {{- if eq $index 0 -}}
                <a href="{{ .RelPermalink }}">Home</a>
            {{- else -}}
                <a href="{{ .RelPermalink }}">{{ .Title }}</a>
            {{- end -}}
            {{- if lt $index $lastIndex -}}{{ $breadcrumbSeparator }}{{- end -}}
        {{- end -}}
    {{- end -}}
</div>
{{- end -}}
